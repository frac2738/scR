<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>7. The Principles of Atlas building [WIP] • scR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="7. The Principles of Atlas building [WIP]">
<meta property="og:description" content="scR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_Pre-processing.html">1. Pre-processing</a>
    </li>
    <li>
      <a href="../articles/2_integration.html">2. Samples integration</a>
    </li>
    <li>
      <a href="../articles/3_annotation.html">3. Dataset annotation</a>
    </li>
    <li>
      <a href="../articles/4_visualisation.html">4. Visualisation</a>
    </li>
    <li>
      <a href="../articles/5_interoperability.html">5. Interoperability</a>
    </li>
    <li>
      <a href="../articles/6_DEG.html">6. DEG</a>
    </li>
    <li>
      <a href="../articles/7_Atlas.html">7. The Principles of Atlas building [WIP]</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="7_Atlas_files/kePrint-0.0.1/kePrint.js"></script><link href="7_Atlas_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>7. The Principles of Atlas building [WIP]</h1>
                        <h4 data-toc-skip class="author">Francesco
Carbone</h4>
            
            <h4 data-toc-skip class="date">Initial commit 10-09-2023
(rebuilt mars 2024)</h4>
      
      
      <div class="hidden name"><code>7_Atlas.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="atlas-principles">1. Atlas principles<a class="anchor" aria-label="anchor" href="#atlas-principles"></a>
</h2>
<p>An atlas does not only combine the data coming from multiple
projects, but it attempts to harmonise its content to maximise the
quantity and quality of the information that can be extracted.</p>
<p>Minimise technical variability is a very important aspect and, for
this process to be successful, great care has to be put into defining
both wet and dry procedures. Every steps of the process should be
codified and documented; in particular:</p>
<ol style="list-style-type: decimal">
<li>Sample source</li>
<li>Wet and dry procedures</li>
<li>Sample information</li>
<li>Analyses steps</li>
</ol>
</div>
<div class="section level2">
<h2 id="process-overview">2. Process overview<a class="anchor" aria-label="anchor" href="#process-overview"></a>
</h2>
<p><img src="7_Atlas/The_circle_of_life.png"></p>
<div class="section level3">
<h3 id="metadata-curation">Metadata curation<a class="anchor" aria-label="anchor" href="#metadata-curation"></a>
</h3>
<p>Particular attention must be take in providing consistency between
projects, diseases and processes.<br>
The information can changed during due course, but the changes must be
documented and detailed.</p>
<p>We can use the definition of controls to make up an example.<br></p>
<div class="alert alert-info">
<p><strong>Note:</strong> The following classification is not real and
it is used only to make a point.</p>
</div>
<p>At the beginning of the project it is decided to divide the control
samples into three groups:</p>
<ul>
<li><p><strong>Real Control</strong>: Healthy individual with no
relationship with any of the patients.</p></li>
<li><p><strong>Healthy Control</strong>: Healthy individual with a
degree of kinship with a patient.</p></li>
<li><p><strong>Surgical Control</strong>: Healthy individual in regards
of the pathologies included in the study, but potentially affected by
some other conditions.</p></li>
</ul>
<p>If later in the study it is decide to add one samples which is known
to be a control but that cannot be classified in any of the three
category, a new group should be created (e.g. <strong>Undefined
Control</strong>) rather than forcing it into one of the existing
category. This is to avoid any confusion and ambiguity during the
interpretation of the results of the downstream analyses.</p>
<p>This kind of critical thinking must be applied to all the available
information, being the samples names, the diseases grouping or the way
dates are recorded.</p>
<div class="section level4">
<h4 id="levels">Levels<a class="anchor" aria-label="anchor" href="#levels"></a>
</h4>
<p>It can be useful to include multiple levels of information, usually
providing an increase in details from one level to the other.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Level 1</strong>: Immune component</p></li>
<li><p><strong>Level 2</strong>: T cells</p></li>
<li><p><strong>Level 3</strong>: T-CD8-central-memory</p></li>
</ol>
<p>Different granularity allows for a better exploration of the data, as
the queries can be tailored to the specific questions the use is trying
to answer.</p>
</div>
</div>
<div class="section level3">
<h3 id="samples-processing">Samples Processing<a class="anchor" aria-label="anchor" href="#samples-processing"></a>
</h3>
<p>To minimise the technical variability, the parameters and conditions
must be controlled, and things like genome built, software versions and
parameters, must be kept invariant and/or the most compatible as
possible. As the projects in the atlas span multiple years, it might be
required the re-processing of some of the older samples.</p>
<table class="table table lightable-paper lightable-hover" style='margin-left: auto; margin-right: auto; font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Project
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CellRanger
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Genome
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
parameters
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Newer
</td>
<td style="text-align:left;">
7.1.0
</td>
<td style="text-align:left;">
2020-A (July 7, 2020)
</td>
<td style="text-align:left;">
include-introns
</td>
</tr>
<tr>
<td style="text-align:left;">
Older
</td>
<td style="text-align:left;">
latest supported by the chemistry
</td>
<td style="text-align:left;">
2020-A (July 7, 2020)
</td>
<td style="text-align:left;">
include-introns
</td>
</tr>
</tbody>
</table>
<p>Cellranger 7.1 supports libraries going back to v2, and it should be
fine to re-analyse the old projects.</p>
<div class="alert alert-info">
<p><strong>Note:</strong> The Bioinformatic platform should be
involved.</p>
</div>
</div>
<div class="section level3">
<h3 id="quality-control">Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h3>
<p>Before the analysis of the sample can start, it is important to
decide a set of rules to clearly quantify and define what makes a
<strong>good sample</strong>, and how to deal with the <strong>bad
ones</strong>. For example, the samples that do not meet the minimum
quality requirements can (and should) be removed or they can be kept and
renamed with a dedicated label (e.g. <strong>bad quality</strong>
samples).</p>
<table class="table table lightable-paper lightable-hover" style='margin-left: auto; margin-right: auto; font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Wet QC
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Dry QC
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Sample quality
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Ok
</td>
<td style="text-align:left;">
Ok
</td>
<td style="text-align:left;">
Good
</td>
</tr>
<tr>
<td style="text-align:left;">
Ok
</td>
<td style="text-align:left;">
Failed
</td>
<td style="text-align:left;">
Low
</td>
</tr>
<tr>
<td style="text-align:left;">
Failed
</td>
<td style="text-align:left;">
Failed
</td>
<td style="text-align:left;">
Bad
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="samples-integration">Samples integration<a class="anchor" aria-label="anchor" href="#samples-integration"></a>
</h3>
<p>Considering the scope and size of the project, a reference-based
mapping workflow will be used. To start, a good quality reference
dataset of control samples will be built, and all the other samples will
be aligned to it. New samples will be added to the older version of the
atlas.</p>
</div>
<div class="section level3">
<h3 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h3>
<p>Once the first integration is done (v1) the quality of the resulted
dataset must be evaluated before any analysis can be started. All the
possible confounders should be tested, and useful metrics should be
collect and stored for future comparison between versions.</p>
</div>
<div class="section level3">
<h3 id="deployment">Deployment<a class="anchor" aria-label="anchor" href="#deployment"></a>
</h3>
<p>The way the end user will interact with the atlas needs to be
addressed as soon as possible, as it will affect how the analysis are
performed. There are currently multiple possibilities:</p>
<ul>
<li>Shiny app with dedicated hardware</li>
<li>Web server built for purpuse (e.g. apache/django)</li>
<li>R object passed down</li>
<li>Power point presentation …</li>
</ul>
<div class="alert alert-info">
<p><strong>Note:</strong> The Bioinformatic platform and the IT
department should be involved.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="proposed-steps">3. Proposed steps<a class="anchor" aria-label="anchor" href="#proposed-steps"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Identification of the projects and samples to include</li>
<li>Re-processing of the non compatible projects (e.g. likely the old
ones)</li>
<li>Metadata curation</li>
<li>Samples QC</li>
<li>Samples classification and inclusion selection</li>
<li>Integration</li>
<li>Atlas validation</li>
<li>Deployment</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Francesco Carbone.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
